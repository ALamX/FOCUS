// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  // output   = "../node_modules/.prisma/client"
}

model cad {
  id             String    @id @default(cuid())
  name           String    @db.VarChar(255)
  owner          User      @relation(fields: [ownerId], references: [id])
  ownerId        String
  areaOfPlay     String?   @db.VarChar(255)
  steamApiKey    String?   @db.VarChar(255)
  whitelisted    Boolean   @default(false)
  towWhitelisted Boolean   @default(false)
  citizens       Citizen[]
  users          User[]    @relation("UsersToCad")
}

model User {
  id              String          @id @default(cuid())
  username        String          @unique @db.VarChar(255)
  password        String          @db.Text
  rank            Rank            @default(USER)
  isLeo           Boolean         @default(false)
  isSupervisor    Boolean         @default(false)
  isEmsFd         Boolean         @default(false)
  isDispatch      Boolean         @default(false)
  isTow           Boolean         @default(false)
  banned          Boolean         @default(false)
  banReason       Boolean?
  avatarUrl       String?         @db.Text
  steamId         String?         @db.VarChar(255)
  whitelistStatus WhitelistStatus @default(ACCEPTED)
  citizens        Citizen[]
  cads            cad[]
  usersToCad      cad[]           @relation("UsersToCad")
}

model Citizen {
  id             String   @id @default(cuid())
  user           User     @relation(fields: [userId], references: [id])
  cad            cad      @relation(fields: [cadId], references: [id])
  cadId          String
  userId         String
  fullName       String   @db.VarChar(255)
  dateOfBirth    DateTime
  gender         String   @db.VarChar(255)
  ethnicity      String   @db.VarChar(255)
  hairColor      String   @db.VarChar(255)
  eyeColor       String   @db.VarChar(255)
  address        String   @db.VarChar(255)
  height         String   @db.VarChar(255)
  weight         String   @db.VarChar(255)
  driversLicense String   @db.VarChar(255)
  weaponLicense  String   @db.VarChar(255)
  pilotLicense   String   @db.VarChar(255)
  ccw            String   @db.VarChar(255)
  imageId        String?  @db.Text
  note           String?  @db.Text
  dead           Boolean  @default(false)
  dateOfDead     DateTime
}

enum Rank {
  OWNER
  ADMIN
  MODERATOR
  USER
}

enum WhitelistStatus {
  ACCEPTED
  PENDING
  DECLINED
}
